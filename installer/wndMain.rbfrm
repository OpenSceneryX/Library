#tag WindowBegin Window wndMain   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   "True"   Composite       =   "False"   Frame           =   0   FullScreen      =   "False"   HasBackColor    =   "False"   Height          =   526   ImplicitInstance=   "True"   LiveResize      =   "True"   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   "False"   MaxWidth        =   32000   MenuBar         =   341440760   MenuBarVisible  =   "True"   MinHeight       =   482   MinimizeButton  =   "True"   MinWidth        =   453   Placement       =   0   Resizeable      =   "True"   Title           =   "#App.kApplicationName"   Visible         =   "True"   Width           =   557   Begin Canvas Canvas1      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   "True"      Backdrop        =   200112520      Enabled         =   True      EraseBackground =   "True"      Height          =   52      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Top             =   14      UseFocusRing    =   "True"      Visible         =   True      Width           =   236      BehaviorIndex   =   0   End   Begin Thread thrBuildAndCheckManifests      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      Priority        =   6      Scope           =   0      StackSize       =   0      TabPanelIndex   =   0      Top             =   -65      Width           =   32      BehaviorIndex   =   1   End   Begin HTTPSocket sockManifest      Address         =   ""      ControlOrder    =   3      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   374      Port            =   80      Scope           =   0      TabPanelIndex   =   0      Top             =   -65      Width           =   32      yield           =   0      BehaviorIndex   =   2   End   Begin Thread thrCheckFolderStructure      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   62      Priority        =   6      Scope           =   0      StackSize       =   0      TabPanelIndex   =   0      Top             =   -65      Width           =   32      BehaviorIndex   =   3   End   Begin EditField fldMessage      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   "True"      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   "True"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   356      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LimitText       =   0      LockBottom      =   "True"      LockLeft        =   "True"      LockRight       =   "True"      LockTop         =   "True"      Mask            =   ""      Multiline       =   "True"      Password        =   ""      ReadOnly        =   "True"      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   "True"      Styled          =   ""      TabIndex        =   5      TabPanelIndex   =   0      Text            =   ""      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   10      Top             =   118      Underline       =   ""      UseFocusRing    =   "True"      Visible         =   True      Width           =   517      BehaviorIndex   =   4   End   Begin ProgressBar prgBar      AutoDeactivate  =   "True"      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   137      LockBottom      =   "True"      LockLeft        =   "True"      LockRight       =   "True"      LockTop         =   "False"      Maximum         =   100      Scope           =   0      TabPanelIndex   =   0      Top             =   486      Value           =   0      Visible         =   "False"      Width           =   400      BehaviorIndex   =   5   End   Begin HTTPSocket sockFile      Address         =   ""      ControlOrder    =   7      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   419      Port            =   80      Scope           =   0      TabPanelIndex   =   0      Top             =   -65      Width           =   32      yield           =   0      BehaviorIndex   =   6   End   Begin StaticText StaticText1      AutoDeactivate  =   "True"      Bold            =   "True"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      Text            =   "#kXPlaneFolder"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   10      Top             =   81      Underline       =   ""      Visible         =   True      Width           =   126      BehaviorIndex   =   7   End   Begin StaticText txtXplaneFolder      AutoDeactivate  =   "True"      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   158      LockBottom      =   ""      LockLeft        =   "True"      LockRight       =   "True"      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   10      Top             =   81      Underline       =   ""      Visible         =   True      Width           =   293      BehaviorIndex   =   8   End   Begin PushButton btnSetXPlaneFolder      AutoDeactivate  =   "True"      Bold            =   ""      Cancel          =   ""      Caption         =   "#kSet"      Default         =   ""      Enabled         =   "False"      Height          =   29      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   457      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   "True"      LockTop         =   ""      Scope           =   0      TabIndex        =   10      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   10      Top             =   77      Underline       =   ""      Visible         =   True      Width           =   80      BehaviorIndex   =   9   End   Begin PushButton btnBegin      AutoDeactivate  =   "True"      Bold            =   ""      Cancel          =   ""      Caption         =   "#kGo"      Default         =   ""      Enabled         =   "False"      Height          =   51      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   457      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   "True"      LockTop         =   ""      Scope           =   0      TabIndex        =   11      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      Top             =   14      Underline       =   ""      Visible         =   True      Width           =   80      BehaviorIndex   =   10   End   Begin Thread thrUpdateFolderStructure      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   106      Priority        =   6      Scope           =   0      StackSize       =   0      TabPanelIndex   =   0      Top             =   -65      Width           =   32      BehaviorIndex   =   11   End   Begin StaticText txtProgress      AutoDeactivate  =   "True"      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   "True"      LockLeft        =   "True"      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   13      TabPanelIndex   =   0      Text            =   ""      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   10      Top             =   486      Underline       =   ""      Visible         =   True      Width           =   105      BehaviorIndex   =   12   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  setupOSXFolder()		  displayXPlaneFolder()		  		  showMessage(kCheckingInstallerVersion)		  		  dim httpSocket as HTTPSocket = new HTTPSocket()		  dim content as String = httpSocket.get(App.kURLVersion, 10)		  		  if (httpSocket.HTTPStatusCode = 200) then		    if (App.shortVersion <> content) then		      showMessage(kNewInstallerAvailable)		      return		    else		      showMessage(kInstallerVersionUpToDate)		    end if		  else		    showMessage(kCouldntCheckInstallerVersion)		  end if		  		  showMessage(kSeparator)		  		  checkOSXFolder()		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub downloadNextFile()		  if (pPendingFiles.Count > 0) then		    dim filePath as String = normaliseFilePath(pPendingFiles.item(1))		    dim destinationFolderItem as FolderItem = getTemporaryFolderItem()		    dim i as Integer		    dim parts() as String = filePath.split("/")		    		    txtProgress.visible = true		    txtProgress.text = App.processParameterizedString(kFilesRemain, Array(str(pPendingFiles.count)))		    showMessage(filePath)		    		    dim url as string = App.kRepositoryURL + "/repository"		    		    for i = 0 to ubound(parts)		      if (parts(i) <> "") then url = url + "/"		      url = url + encodeURLComponent(parts(i))		    next		    		    url = url + ".zip"		    		    sockFile.get(url, destinationFolderItem)		  else		    showMessage(kInstallComplete)		    prgBar.visible = false		    txtProgress.visible = false		    btnSetXPlaneFolder.enabled = true		  end if		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub showMessage(message as String, optional parameters() as String)		  message = App.processParameterizedString(message, parameters)		  fldMessage.appendText(message + endOfLine)		  fldMessage.scrollPosition = 10000000		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub setupOSXFolder()		  dim foundPrevious as boolean = false		  dim tempFolderItem as FolderItem		  		  // Newest name takes top priority, followed by older releases		  pOsxFolderItem = App.pXPlaneFolder.child("Custom Scenery").child("OpenSceneryX")		  if (pOsxFolderItem.exists()) then		    foundPrevious = true		  end if		  		  tempFolderItem = App.pXPlaneFolder.child("Custom Scenery").child("OpenSceneryX-1.1.0")		  if (tempFolderItem.exists) then		    if (foundPrevious) then		      Utilities.deleteContentsOfFolder(tempFolderItem)		      tempFolderItem.delete()		    else		      tempFolderItem.moveFileTo(pOsxFolderItem)		      foundPrevious = true		    end if		  end if		  		  tempFolderItem = App.pXPlaneFolder.child("Custom Scenery").child("OpenSceneryX-1.0.0")		  if (tempFolderItem.exists) then		    if (foundPrevious) then		      Utilities.deleteContentsOfFolder(tempFolderItem)		      tempFolderItem.delete()		    else		      tempFolderItem.moveFileTo(pOsxFolderItem)		      foundPrevious = true		    end if		  end if		  		  if (not foundPrevious) then		    pOsxFolderItem.createAsFolder()		  end if		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub displayXPlaneFolder()		  txtXplaneFolder.text = App.pXPlaneFolder.absolutePath		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub checkOSXFolder()		  pLocalManifest = new FolderManifest()		  pServerManifest = new FolderManifest()		  		  thrBuildAndCheckManifests.run()		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub preProcessLocalFolderItem(osxFolderItem as FolderItem)		  // Fix any one-off issues here, usually caused by case changes		  		  // Problem with b767-300ER changing to b767-300er		  dim b767FolderItem as FolderItem = osxFolderItem.child("objects").child("aircraft").child("jets").child("heavy").child("b767-300ER")		  if (b767FolderItem.exists()) then		    b767FolderItem.name = "b767-300er"		  end if		  		  dim b747EasyJetFolderItem as FolderItem = osxFolderItem.child("doc").child("B737-800 Easyjet.html")		  if (b747EasyJetFolderItem.exists()) then		    b747EasyJetFolderItem.name = "B737-800 easyJet.html"		  end if		  		  dim a320EasyJetFolderItem as FolderItem = osxFolderItem.child("doc").child("A320 Easyjet.html")		  if (a320EasyJetFolderItem.exists()) then		    a320EasyJetFolderItem.name = "A320 easyJet.html"		  end if		  		Exception err as NilObjectException		  // Catch this in case any folder item doesn't exist (new install)		End Sub	#tag EndMethod	#tag Property, Flags = &h0		pOsxFolderItem As FolderItem	#tag EndProperty	#tag Property, Flags = &h0		pLocalManifest As FolderManifest	#tag EndProperty	#tag Property, Flags = &h0		pServerManifest As FolderManifest	#tag EndProperty	#tag Property, Flags = &h0		pPendingFiles As Collection	#tag EndProperty	#tag Property, Flags = &h0		pDeletedFiles As Collection	#tag EndProperty	#tag Constant, Name = kGo, Type = String, Dynamic = True, Default = \"Go", Scope = Public		#Tag Instance, Platform = Any, Language = fr, Definition  = \"D\xC3\xA9marrer"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Endavant"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Vai"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Anfangen"	#tag EndConstant	#tag Constant, Name = kSet, Type = String, Dynamic = True, Default = \"Set\xE2\x80\xA6", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Setear\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"R\xC3\xA9glages\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Tria\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Imposta\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Einstellungen\xE2\x80\xA6"	#tag EndConstant	#tag Constant, Name = kXPlaneFolder, Type = String, Dynamic = True, Default = \"X-Plane\xC2\xAE Folder:", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Carpeta X-Plane\xC2\xAE:"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Dossier X-Plane\xC2\xAE:"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Carpeta X-Plane\xC2\xAE:"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Cartella di X-Plane\xC2\xAE"		#Tag Instance, Platform = Any, Language = de, Definition  = \"X-Plane\xC2\xAE Ordner:"	#tag EndConstant	#tag Constant, Name = kError, Type = String, Dynamic = True, Default = \"Error: \"${1}\"", Scope = Public		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Erreur.\"${1}\""		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Error: \xC2\xAB${1}\xC2\xBB"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Errore: \"${1}\""		#Tag Instance, Platform = Any, Language = de, Definition  = \"Fehler: \"${1}\""	#tag EndConstant	#tag Constant, Name = kExtractionFailed, Type = String, Dynamic = True, Default = \"Extraction of \"${1}\" failed: \"${2}\"", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Extracci\xC3\xB3n de \"${1}\" fall\xC3\xB3: \"${2}\""		#Tag Instance, Platform = Any, Language = fr, Definition  = \"L\'extraction de \"{1}\" a \xC3\xA9chou\xC3\xA9e:\"{2}\""		#Tag Instance, Platform = Any, Language = ca, Definition  = \"L\'extracci\xC3\xB3 de \xC2\xAB${1}\xC2\xBB ha fallat: \xC2\xAB${2}\xC2\xBB"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Estrazione di \"${1}\" non avvenuta: \"${2}\""		#Tag Instance, Platform = Any, Language = de, Definition  = \"Dekomprimierung von \"${1}\" ist mislungen \"${2}\""	#tag EndConstant	#tag Constant, Name = kErrorHTTP, Type = String, Dynamic = True, Default = \"There was an error downloading the file (status ${1})\x2C the download was aborted.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Se produjo un error descargando el archivo (status ${1})\x2C la descarga fue abortada."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Erreur de t\xC3\xA9l\xC3\xA9chargement de fichier (status${1})\x2C le t\xC3\xA9l\xC3\xA9chargement a \xC3\xA9t\xC3\xA9 annul\xC3\xA9."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'ha produ\xC3\xAFt un error en la desc\xC3\xA0rrega el fitxer (estat ${1})\x2C s\'ha cance\xC5\x80lat la desc\xC3\xA0rrega."		#Tag Instance, Platform = Any, Language = it, Definition  = \"\xC3\x88 successo un errore scaricando il file (status ${1})\x2C lo scaricamento \xC3\xA8 stato interrotto."		#Tag Instance, Platform = Any, Language = de, Definition  = \"W\xC3\xA4hrend des Downloads der Datei (status ${1}) ist ein Fehler aufgetreten\x2C Download wird abgebrochen."	#tag EndConstant	#tag Constant, Name = kErrorDownloading, Type = String, Dynamic = True, Default = \"Error downloading (code ${1})\x2C retrying\xE2\x80\xA6", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Error descargando (code ${1})\x2C reintentando\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Erreur de t\xC3\xA9l\xC3\xA9chargement (code${1})\x2C nouvel essai\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Error en la desc\xC3\xA0rrega (codi ${1})\x2C provant-ho de nou\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = it, Definition  = \"\xC3\x88 successo un errore scaricando (code ${1})\x2C sto riprovando\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Download Fehler (code ${1})\x2C erneuter Versuch\xE2\x80\xA6"	#tag EndConstant	#tag Constant, Name = kManifestDownloaded, Type = String, Dynamic = True, Default = \"The download of the list of files is complete.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"La descarga de la lista de archivos fue completada."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"T\xC3\xA9l\xC3\xA9chargement de la liste de fichiers effectu\xC3\xA9"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'ha completat la desc\xC3\xA0rrega de la llista de fitxers."		#Tag Instance, Platform = Any, Language = it, Definition  = \"Lo scaricamento della lista dei files \xC3\xA8 completato."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Alle Dateien wurden korrekt heruntergeladen."	#tag EndConstant	#tag Constant, Name = kErrorManifest, Type = String, Dynamic = True, Default = \"There was a problem with the list of files downloaded from the server\x2C please try again later.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Hay un problema con la lista de archivos descargados desde el servidor\x2C por favor intente de nuevo luego."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Probl\xC3\xA8me lors du t\xC3\xA9l\xC3\xA9chargement de la liste de fichiers depuis le serveur\x2C re-essayez plus tard."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Hi ha un problema amb la llista de fitxers descarregada del servidor\x2C proveu-ho un altre cop m\xC3\xA9s tard."		#Tag Instance, Platform = Any, Language = it, Definition  = \"C\'\xC3\xA8 stato un problema con la lista dei files scaricati dal server\x2C per favore prova ancora."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Es ist ein problem mit der Liste der vom Server heruntergeladenen Dateien aufgetreten\x2C bitte versuchen sie es sp\xC3\xA4ter noch einmal."	#tag EndConstant	#tag Constant, Name = kCollectingLocalFileInformation, Type = String, Dynamic = True, Default = \"Collecting local file information\xE2\x80\xA6", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Recabando informaci\xC3\xB3n de archivos locales\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Collecte des informations locales\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'est\xC3\xA0 recollint informaci\xC3\xB3 dels fitxers locals\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Sto raccogliendo informazioni sul file\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Untersuchung der lokalen Datei Struktur\xE2\x80\xA6"	#tag EndConstant	#tag Constant, Name = kComplete, Type = String, Dynamic = True, Default = \"Complete.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Completo."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Termin\xC3\xA9."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Completat."		#Tag Instance, Platform = Any, Language = it, Definition  = \"Completato."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Abgeschlossen."	#tag EndConstant	#tag Constant, Name = kDownloadingManifest, Type = String, Dynamic = True, Default = \"Connecting to the server and loading the list of available files\x2C please wait\xE2\x80\xA6", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Conectando con el servidor y descargando la lista de archivos disponibles\x2C espere por favor\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Connection au erveur et t\xC3\xA9l\xC3\xA9chargement de la listede fichiers disponible\x2C attendez."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'est\xC3\xA0 connectant amb el servidor per descarregar la llista de fitxers disponibles\x2C espereu\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Mi sto connettendo al server e sto caricando la lista dei file disponibili\x2C attendi per favore\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Die Verbindung zum Server wird aufgenommen und die Liste der verf\xC3\xBCgbaren Dateien wird untersucht\x2C bitte haben sie einen Moment Geduld."	#tag EndConstant	#tag Constant, Name = kErrorDownloadingManifest, Type = String, Dynamic = True, Default = \"There was an error while fetching the list of files - attempt ${1}.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Ocurri\xC3\xB3 un error revisando la lista de archivos - intento  ${1}."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Erreur lors de la lecture de la lsite de fichiers - tentavive ${1}."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'ha podu\xC3\xAFt un error en obtenir la llista de fitxers - intent ${1}."		#Tag Instance, Platform = Any, Language = it, Definition  = \"C\'\xC3\xA8 stato un errore andando a prendere la lista dei files - tentativo ${1}."		#Tag Instance, Platform = Any, Language = de, Definition  = \"W\xC3\xA4hrend der untersuchung der Liste der verf\xC3\xBCgbaren Dateien ist ein Fehler aufgetreten - Versuch ${1}."	#tag EndConstant	#tag Constant, Name = kGivingUp, Type = String, Dynamic = True, Default = \"Giving up.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Abandonando."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Abandon."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Deixant-ho."		#Tag Instance, Platform = Any, Language = it, Definition  = \"Rinunciando."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Abbruch."	#tag EndConstant	#tag Constant, Name = kInstallUpToDate, Type = String, Dynamic = True, Default = \"Your OpenSceneryX install is completely up to date\x2C you may now quit this installer.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Su instalaci\xC3\xB3n de OpenSceneryX est\xC3\xA1 completamente actualizada\x2C puede salir ahora de este instalador."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Votre installation OpenSceneryX est \xC3\xA0 jour. Vous pouvez maintenant quitter l\'installeur."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"La vostra insta\xC5\x80laci\xC3\xB3 de l\'OpenSceneryX est\xC3\xA0 totalment actualitzada\x2C ara podeu sortir de l\'insta\xC5\x80lador."		#Tag Instance, Platform = Any, Language = it, Definition  = \"La tua cartella di OpenSceneryX \xC3\xA8 aggiornata\x2C ora puoi chiudere questo installatore."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Ihre OpenSceneryX Installation ist jetz auf dem neueste stand\x2C sie k\xC3\xB6nnen jetzt das Programm verlassen."	#tag EndConstant	#tag Constant, Name = kInstallOutOfDate, Type = String, Dynamic = True, Default = \"Your OpenSceneryX install is out of date\x2C ${1} files need to be deleted and ${2} files need to be downloaded\x2C press the \'Go\' button to begin the process.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Su instalaci\xC3\xB3n de OpenSceneryX est\xC3\xA1 desactualizada\x2C ${1} archivos necesitan ser borrados y ${2} archivos deben ser descargados\x2C presione el bot\xC3\xB3n \'Go\' para comenzar el proceso."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Votre installation OpenSceneryX n\'est pas \xC3\xA0 jour\x2C ${1} fichiers doiventr \xC3\xAAtre supprim\xC3\xA9s et ${2} fichiers doivent \xC3\xAAtre t\xC3\xA9l\xC3\xA9charg\xC3\xA9s. Cliquer sur d\xC3\xA9marrer pour d\xC3\xA9buter l\'installation."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"La vostra insta\xC5\x80laci\xC3\xB3 de l\'OpenSceneryX est\xC3\xA0 desactualitzada\x2C cal suprimir ${1} fitxers i descarregar ${2} fitxers. Feu clic a \'Endavant\' per iniciar el proc\xC3\xA9s."		#Tag Instance, Platform = Any, Language = it, Definition  = \"La tua cartella OpenSceneryX non \xC3\xA8 aggiornata\x2C ${1} files devono essere cancellati e ${2} devono essere scaricati\x2C premi il pulsante \"Vai\" per iniziare il processo."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Ihre OpenSceneryX Installation ist \xC3\xBCberholt\x2C ${1} Dateien m\xC3\xBCssen gel\xC3\xB6scht und ${2} Dateien m\xC3\xBCssen heruntergeladen werden. Dr\xC3\xBCcken sie bitte auf den \"Anfangen\" button um den Installationsprozess zu starten."	#tag EndConstant	#tag Constant, Name = kSeparator, Type = String, Dynamic = False, Default = \"----", Scope = Public	#tag EndConstant	#tag Constant, Name = kDeletingFiles, Type = String, Dynamic = True, Default = \"Deleting Files:", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Borrando archivos:"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Effacement des fichiers:"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Supimint els fitxers:"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Cancello i files:"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Volgende Dateien werden Gel\xC3\xB6scht:"	#tag EndConstant	#tag Constant, Name = kDownloadingChangedFiles, Type = String, Dynamic = True, Default = \"Downloading Changed Files:", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Descargando Archivos Cambiados:"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"T\xC3\xA9l\xC3\xA9chargement des fichiers \xC3\xA0 jour:"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Descarregant els fitxers modificats:"		#Tag Instance, Platform = Any, Language = it, Definition  = \"Scarico i files cambiati:"		#Tag Instance, Platform = Any, Language = de, Definition  = \"Download der modifizierten Dateien:"	#tag EndConstant	#tag Constant, Name = kInstallComplete, Type = String, Dynamic = True, Default = \"Your OpenSceneryX installation is now Complete.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Su instalaci\xC3\xB3n de OpenSceneryX ya fue Completada."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Votre installation OpenSceneryX est compl\xC3\xA8te."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'ha completat la insta\xC5\x80laci\xC3\xB3 del vostre OpenSceneryX."		#Tag Instance, Platform = Any, Language = it, Definition  = \"Installazione di OpenSceneryX  completata."		#Tag Instance, Platform = Any, Language = de, Definition  = \"Ihre OpenSceneryX Installation ist jetzt fertig."	#tag EndConstant	#tag Constant, Name = kFilesRemain, Type = String, Dynamic = True, Default = \"${1} remain", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"${1} restantes"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"${1} restant"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"en resten ${1}"		#Tag Instance, Platform = Any, Language = it, Definition  = \"${1} rimanenti"		#Tag Instance, Platform = Any, Language = de, Definition  = \"${1} verbleiben"	#tag EndConstant	#tag Constant, Name = kCouldntCheckInstallerVersion, Type = String, Dynamic = True, Default = \"The installer version couldn\'t be checked\x2C continuing anyway\xE2\x80\xA6", Scope = Public	#tag EndConstant	#tag Constant, Name = kNewInstallerAvailable, Type = String, Dynamic = True, Default = \"There is a new version of the installer available\x2C please download it from the OpenSceneryX website - click the logo at the top of this window", Scope = Public	#tag EndConstant	#tag Constant, Name = kCheckingInstallerVersion, Type = String, Dynamic = True, Default = \"Checking installer version\xE2\x80\xA6", Scope = Public	#tag EndConstant	#tag Constant, Name = kInstallerVersionUpToDate, Type = String, Dynamic = True, Default = \"Installer is the most up to date version\x2C continuing\xE2\x80\xA6", Scope = Public	#tag EndConstant#tag EndWindowCode#tag Events Canvas1	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  showURL(App.kURLWebsite)		End Function	#tag EndEvent	#tag Event		Sub Open()		  me.mouseCursor = System.Cursors.FingerPointer		End Sub	#tag EndEvent#tag EndEvents#tag Events thrBuildAndCheckManifests	#tag Event		Sub Run()		  prgBar.visible = true		  prgBar.maximum = 0		  txtProgress.visible = false		  		  showMessage(kCollectingLocalFileInformation)		  preProcessLocalFolderItem(pOsxFolderItem)		  pLocalManifest.gatherManifestFromLocalFolderItem(pOsxFolderItem)		  showMessage(kComplete)		  showMessage(kSeparator)		  		  showMessage(kDownloadingManifest)		  sockManifest.Get(App.kRepositoryURL + "/manifest.xml")		  		  dim tries as integer = 0		  		  do		    while (sockManifest.isConnected and sockManifest.lastErrorCode = sockManifest.NoError)		      // Wait half a second		      me.sleep(500)		    wend		    		    if (sockManifest.lastErrorCode <> sockManifest.NoError) then		      // Socket error		      tries = tries + 1		      if (tries <= App.kConnectionRetries) then		        showMessage(kErrorDownloadingManifest, Array(str(tries)))		        sockManifest.Get(App.kRepositoryURL + "/manifest.xml")		      else		        showMessage(kGivingUp)		        prgBar.visible = false		        exit		      end if		    else		      // Socket exited cleanly		      exit		    end if		  loop		End Sub	#tag EndEvent#tag EndEvents#tag Events sockManifest	#tag Event		Sub PageReceived(url as string, httpStatus as integer, headers as internetHeaders, content as string)		  prgBar.visible = false		  txtProgress.visible = false		  		  if pServerManifest.gatherManifestFromXMLString(content) then		    showMessage(kManifestDownloaded)		    thrCheckFolderStructure.run		  else		    showMessage(kErrorManifest)		  end if		  		End Sub	#tag EndEvent	#tag Event		Sub ReceiveProgress(bytesReceived as integer, totalBytes as integer, newData as string)		  prgBar.maximum = totalBytes		  prgBar.value = bytesReceived		End Sub	#tag EndEvent#tag EndEvents#tag Events thrCheckFolderStructure	#tag Event		Sub Run()		  dim i as Integer		  		  prgBar.visible = true		  prgBar.maximum = 0		  txtProgress.visible = false		  		  pPendingFiles = new Collection()		  pDeletedFiles = new Collection()		  		  pLocalManifest.getDifferences(pServerManifest, pPendingFiles, pDeletedFiles)		  		  if (pPendingFiles.count = 0 and pDeletedFiles.count = 0) then		    showMessage(kInstallUpToDate)		  else		    showMessage(kInstallOutOfDate, Array(str(pDeletedFiles.count), str(pPendingFiles.count)))		    btnBegin.enabled = true		  end if		  		  showMessage(kSeparator)		  prgBar.visible = false		  btnSetXPlaneFolder.enabled = true		End Sub	#tag EndEvent#tag EndEvents#tag Events sockFile	#tag Event		Sub ReceiveProgress(bytesReceived as integer, totalBytes as integer, newData as string)		  prgBar.maximum = totalBytes		  prgBar.value = bytesReceived		End Sub	#tag EndEvent	#tag Event		Sub DownloadComplete(url as string, httpStatus as integer, headers as internetHeaders, file as folderItem)		  if (httpStatus = 200) then		    dim filePath as String = pPendingFiles.item(1)		    dim zar as ZipArchive = new ZipArchive		    dim f as FolderItem, e as ZipEntry, i as Integer		    		    pPendingFiles.remove(1)		    		    dim destinationFolderItem as FolderItem = pLocalManifest.getLocalFolderItem(filePath)		    if (destinationFolderItem.exists) then destinationFolderItem.delete()		    		    if not zar.Open(file, false) then		      showMessage(kError, Array(zar.ErrorMessage))		      return		    end		    		    e = zar.Entry(1)		    f = e.MakeDestination(getTemporaryFolderItem().parent, false)		    		    if not e.Extract(f) then		      showMessage(kExtractionFailed, Array(e.RawPath, e.ErrorMessage))		      return		    end		    		    if not zar.Close() then		      showMessage(kError, Array(zar.ErrorMessage))		      return		    end		    		    f.moveFileTo(destinationFolderItem)		    file.delete()		    		    downloadNextFile()		    		  else		    showMessage(kErrorHTTP, Array(str(httpStatus)))		    prgBar.visible = false		    txtProgress.visible = false		  end if		End Sub	#tag EndEvent	#tag Event		Sub Error(code as integer)		  showMessage(kErrorDownloading, Array(str(code)))		  downloadNextFile()		End Sub	#tag EndEvent#tag EndEvents#tag Events btnSetXPlaneFolder	#tag Event		Sub Action()		  if (App.getXPlaneFolder(false)) then		    btnSetXPlaneFolder.enabled = false		    btnBegin.enabled = false		    setupOSXFolder()		    displayXPlaneFolder()		    checkOSXFolder()		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events btnBegin	#tag Event		Sub Action()		  btnBegin.enabled = false		  btnSetXPlaneFolder.enabled = false		  thrUpdateFolderStructure.run()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events thrUpdateFolderStructure	#tag Event		Sub Run()		  dim i as Integer		  		  prgBar.visible = true		  prgBar.maximum = 0		  		  if (pDeletedFiles.count > 0) then		    showMessage(endofline + kDeletingFiles)		    for i = 1 to pDeletedFiles.count		      showMessage(pDeletedFiles.item(i))		      pLocalManifest.getLocalFolderItem(pDeletedFiles.item(i)).delete		    next		  end if		  		  showMessage(kDownloadingChangedFiles)		  downloadNextFile()		  		End Sub	#tag EndEvent#tag EndEvents