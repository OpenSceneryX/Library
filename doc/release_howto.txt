Release Howto
=============

0. Pre-build the library

  $ python build.py

1. Check the build for missing virtual paths

  $ python check.py

2. Create release branch

3. Update release notes to include version and date

4. Update "Enhanced By" logo to correct version number

5. Commit release changes, tag and merge release changes back into develop

6. Clean target folder and build library

  $ python build.py
  
  ENSURE 'y' is selected for 'Build PDF'

7. Create a copy of the built OpenSceneryX-x.x.x folder, rename it to 'OpenSceneryX'

8. Zip this to create the monolithic zip file:

  $ export COPYFILE_DISABLE=true
  $ zip -r OpenSceneryX.zip OpenSceneryX

9. Run Manifester on built OpenSceneryX-x.x.x folder and save manifest.xml

10. Run Packager

  $ python package.py

11. Zip OpenSceneryX-Website-x.x.x.tar and OpenSceneryX-DeveloperPack-x.x.x/

	$ zip OpenSceneryX-Website-x.x.x.tar.zip OpenSceneryX-Website-x.x.x.tar
	$ zip -r OpenSceneryX-DeveloperPack-x.x.x.zip OpenSceneryX-DeveloperPack-x.x.x

12. Zip manifest.xml using the command line

	$ zip manifest.xml.zip manifest.xml

13. Clear /new and /old on the server

14. Upload OpenSceneryX-Website-x.x.x.tar.zip and OpenSceneryX-DeveloperPack-x.x.x.zip into /new/:

    $ scp OpenSceneryX-Website-x.x.x.tar.zip <server>:/var/www/austin/new/
    $ scp OpenSceneryX-DeveloperPack-x.x.x.zip <server>:/var/www/austin/new/

15. Upload manifest.xml.zip and manifest.xml into /new/

    $ scp manifest.xml.zip <server>:/var/www/austin/new/

16. Upload the monolithic zip file 'OpenSceneryX.zip' into AWS S3 bucket

17. Copy /downloads/ into /old/

18. Make a copy of repository/ into new/ on the server

19. Use rsync to upload the new library:

    $ /usr/bin/rsync -arv --checksum OpenSceneryX-x.x.x/ <server>:/var/www/austin/new/repository/
    
----------------------------------------------

20. Prepare blog post while uploads ongoing

----------------------------------------------

21. Extract website zip on site into /new/

    $ unzip OpenSceneryX-Website-x.x.x.tar.zip
    $ tar -xf OpenSceneryX-Website-x.x.x.tar

22. Put site into maintenance mode

  $ mv wp/maintenance-disabled wp/.maintenance

23. Move /doc/, /extras/, /facades/, /forests/, /lines/, /manifest.xml, /manifest.xml.zip, /objects/, /polygons/, /repository/, /library-sitemap.xml and robots.txt into /old/

24. Move /new/repository/ to /repository/

25. Move /new/OpenSceneryX-Website-x.x.x/* to /

26. Move /new/manifest.xml.zip and /new/manifest.xml to /

27. Move /new/OpenSceneryX-DeveloperPack-x.x.x.zip to /downloads/

28. Move /new/OpenSceneryX.zip to /downloads/

29. Ensure /versioninfo has the latest information about the installer in it.

30. Correct ownership of folder structure

  $ chown -R apache:apache public_html

31. Take site out of maintenance mode

  $ mv wp/.maintenance wp/maintenance-disabled

32. Log into Cloudflare and clear all caches.

33. Log in to Google Webmaster tools and resubmit library-sitemap.xml

34. Log in to Bing Webmaster tools and resubmit library-sitemap.xml

35. Create new section in release note for next changes

36. Promotion:
	- Update x-plane.org Download Manager entry
	- Update first post in x-plane.org main OpenSceneryX thread
	- Create a new post in the x-plane.org 'News' forum
	- Post an article on the site
	- Tweet
  - Reddit r/Xplane